## mock은 stub과 다르다.

저는 테스트 코드를 작성시 mock과 stub의 차이를 생각하지 않고 써왔습니다.  
최근 마틴파울러의 블로그에서 [Mocks Aren't Stubs](https://martinfowler.com/articles/mocksArentStubs.html) 라는 글을 발견했습니다.

원문의 내용은 JAVA로 작성 되었지만, 본 포스팅에서는 **Typescript + jest**로 정리하며 작성해보겠습니다.

## Test Double

마틴파울러는 **Test Doble**을 테스트계의 스턴트맨이라고 소개합니다.  
스턴트맨은 배우 대신 위험을 무릅쓰고 대역을 합니다. 테스트 코드에서 대역을 쓰는 것에 착안하여 이름을 이렇게 지었고,  
영화를 찍기 위해 위험한 액션을 대신 해주는 것이 스턴트맨이라면  
테스트를 통과하기 위해 액션을 대신 해주는 것이 **Test Double**입니다.

![1](./1.gif)

즉, 테스트를 목적으로 실제 대신 사용되는 모든 종류의 가상 객체에 대해 **Test Double**이라는 용어를 사용합니다.

#### 더미 객체 (Dummy Object)

Dummy Object는 전달되지만 실제로는 사용되지 않습니다.  
일반적으로 파라미터를 전달하기 위한 용도로만 사용됩니다.

#### 가짜 객체 (Fake Object)

Fake Object는 실제로 동작하는 객체를 의미합니다.  
실제 프로덕션 환경에 적합하지 않지만 지름길의 역할을 합니다.  
(인메모리 데이터베이스가 좋은 예시입니다.)

#### 스텁 (Stub)

Stub은 테스트 중 호출된 경우에 대해 미리 만들어진 결과물을 응답하게 합니다.  
보통 테스트를 위해 만들어지며 테스트 이외에 사용되지 않습니다.

#### 스파이 (Spy)

Spy는 그들이 어떻게 호출되었는지에 따라 일부 정보를 기록하는 스텁입니다.  
주로 어떤 동작이 이루어졌는지 검증하는 용도로 사용됩니다.

#### 모의 (Mock)

Mock은 호출했을 때 사전에 정의된 명세대로의 결과를 돌려주도록 미리 프로그래밍 되어있습니다.
예상치 못한 호출이 있을 경우 예외를 던질 수 있으며, 모든 호출이 예상된 것이었는지 확인할 수 있습니다.

이렇게 많은 종류의 Test Double이 있습니다.**  
우리가 주의깊게 봐야할 점은 이들 중 Mock만 행동을 검증합니다.**  
보통 다른 Test Double들은 상태 검증에서만 사용할 수 있습니다.